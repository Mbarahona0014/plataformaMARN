!function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons","datatables.net-buttons/js/buttons.html5.js","datatables-buttons-excel-styles/js/buttons.html5.styles.js"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$){return root=root||window,$&&$.fn.dataTable||($=require("datatables.net")(root,$).$),$.fn.dataTable.Buttons||require("datatables.net-buttons")(root,$),$.fn.dataTable.Buttons.excelHtml5||require("datatables.net-buttons/js/buttons.html5.js")(root,$),$.fn.dataTable.Buttons._applyExcelStyles||require("datatables-buttons-excel-styles/js/buttons.html5.styles.js")(root,$),factory($,0,root.document)}:factory(jQuery,window,document)}(function($,window,document,undefined){var DataTable=$.fn.dataTable;DataTable.ext.buttons.excelHtml5.applyStyles=function(xlsx){var excelStyles=this.excelStyles||this.exportOptions.excelStyles;excelStyles!==undefined&&(excelStyles=_makeArray(excelStyles),this.excelStyles=_replaceTemplatesWithStyles(excelStyles),this._applyExcelStyles(xlsx))},DataTable.ext.buttons.excelHtml5.getExcelTemplates=function(){return!1===_templatesGenerated&&_generate_table_templates(),_templates},DataTable.ext.buttons.excelHtml5.listExcelTemplates=function(){var templates=this.getExcelTemplates(),list=[];for(var i in templates)templates[i].desc!==undefined&&list.push(i+","+templates[i].desc);console.log(list.join("\n"))};function _gen_header(themeColor){return{cells:["sh","sf"],style:{font:{color:_header_font_exceptions[themeColor]!==undefined?_header_font_exceptions[themeColor]:_tc.white},fill:{pattern:{color:themeColor}}}}}function _gen_collines(themeColor){return[{cells:["sh","sf","sA:>"],style:{border:{left:{style:"thin",color:{rgb:themeColor,tint:.4}},right:{style:"thin",color:{rgb:themeColor,tint:.4}}}}}]}function _gen_outline(themeColor){return[{cells:["sh","sf"],style:{border:{top:{style:"thin",color:{rgb:themeColor,tint:.4}},bottom:{style:"thin",color:{rgb:themeColor,tint:.4}}}}},{cells:["sA","sAh","sAf"],style:{border:{left:{style:"thin",color:{rgb:themeColor,tint:.4}}}}},{cells:["s>","s>h","s>f"],style:{border:{right:{style:"thin",color:{rgb:themeColor,tint:.4}}}}}]}function _gen_rowlines(themeColor){return{cells:"s1:-0",style:{border:{top:{style:"thin",color:{rgb:themeColor,tint:.4}},bottom:{style:"thin",color:{rgb:themeColor,tint:.4}}}}}}function _gen_stripes(themeColor){return{cells:"s1:n,2",style:{fill:{pattern:{color:{rgb:themeColor,tint:.8}}}}}}var _templates={b:{desc:"Bold",es:{cells:"s1:-0",style:{font:{b:!0}}}},u:{desc:"Underline",es:{cells:"s1:-0",style:{font:{u:!0}}}},i:{desc:"Italics",es:{cells:"s1:-0",style:{font:{i:!0}}}},title_medium:{desc:"Title: medium size",es:{cells:["st"],style:{font:{sz:16},alignment:{vertical:"center"}},height:28}},currency_us:{desc:"Currency: USD",es:{style:{numFmt:"[$$-en-US] #,##0.00"}}},currency_eu:{desc:"Currency: Euro",es:{style:{numFmt:"[$€-x-euro2] #,##0.00"}}},currency_gb:{desc:"Currency: GBP",es:{style:{numFmt:"[$£-en-GB]#,##0.00"}}},int:{desc:"Number: Integer",es:{style:{numFmt:"#,##0;(#,##0)"}}},decimal_1:{desc:"Number: 1 decimal place",es:{style:{numFmt:"#,##0.0;(#,##0.0)"}}},decimal_2:{desc:"Number: 2 decimal places",es:{style:{numFmt:"#,##0.00;(#,##0.00)"}}},decimal_3:{desc:"Number: 3 decimal places",es:{style:{numFmt:"#,##0.000;(#,##0.000)"}}},decimal_4:{desc:"Number: 4 decimal places",es:{style:{numFmt:"#,##0.0000;(#,##0.0000)"}}},date_long:{desc:"Date: Long format - eg. 24 September 1979",es:{style:{numFmt:"d mmmm yyyy"}}},date_medium:{desc:"Date: Medium format - eg. 4 Jun 1987",es:{style:{numFmt:"d mmm yyyy"}}}},_makeArray=function(value){return Array.isArray(value)?value:[value]},_templatesGenerated=!1,_replaceTemplatesWithStyles=function(excelStyles){var styleArray=[];for(var i in excelStyles)if(excelStyles[i].template!==undefined){!1===_templatesGenerated&&_generate_table_templates();var templateList=_makeArray(excelStyles[i].template);for(var j in templateList){var cells,templateName=templateList[j],template=_getTemplate(templateName);!1!==template?(cells=excelStyles[i].cells||undefined,_addStyles(cells,template.es,styleArray)):console.log("Error: Template '"+templateName+"' not found. Ignoring template.")}}else styleArray.push(excelStyles[i]);return styleArray},_addStyles=function(cells,excelStyles,styleArray){if(Array.isArray(excelStyles))for(var j in excelStyles)Array.isArray(excelStyles[j])?_addStyles(cells,excelStyles[j],styleArray):(cells!==undefined&&(excelStyles[j].cells=cells),styleArray.push(excelStyles[j]));else cells!==undefined&&(excelStyles.cells=cells),styleArray.push(excelStyles)},_getTemplate=function(templateName){return _templates[templateName]||!1},_tc={black:"000000",white:"FFFFFF",blue:"4472C4",blue_gray:"44546A",orange:"ED7D31",gray:"A5A5A5",light_gray:"E7E6E6",gold:"FFC000",cyan:"5B9BD5",green:"70AD47"},_header_font_exceptions={E7E6E6:"000000"},_generate_table_templates=function(){_templatesGenerated=!0;var string,gens={header:_gen_header,rowlines:_gen_rowlines,collines:_gen_collines,outline:_gen_outline,stripes:_gen_stripes};for(var color in _tc)if("white"!=color){var _fullTable=[];for(var gen_key in gens)_templates[gen_key+"_"+color]={desc:(string=gen_key).charAt(0).toUpperCase()+string.slice(1)+": "+color,es:gens[gen_key](_tc[color])},_fullTable.push(_templates[gen_key+"_"+color].es);_templates[color+"_medium"]={desc:"Complete table: "+color,es:_fullTable}}};return DataTable.Buttons});