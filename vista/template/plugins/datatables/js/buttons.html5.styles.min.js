!function(factory){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons","datatables.net-buttons/js/buttons.html5.js"],function($){return factory($,window,document)}):"object"==typeof exports?module.exports=function(root,$){return root=root||window,$&&$.fn.dataTable||($=require("datatables.net")(root,$).$),$.fn.dataTable.Buttons||require("datatables.net-buttons")(root,$),$.fn.dataTable.Buttons.excelHtml5||require("datatables.net-buttons/js/buttons.html5.js")(root,$),factory($,0,root.document)}:factory(jQuery,window,document)}(function($,window,document,undefined){var DataTable=$.fn.dataTable;DataTable.ext.buttons.excelHtml5.customize=function(xlsx){this.applyStyles(xlsx)},DataTable.ext.buttons.excelHtml5.applyStyles=function(xlsx){this._applyExcelStyles(xlsx)};function _parseExcellyReference(cells,sheet,smartRowOption){var matches=/^(s)*(?:-(\d*)(?=\>))*([A-Z]*|[>])*([tmhfb]{1})*(-(?=[0-9]+))*([0-9]*)(?:(\:)(?:-(\d*)(?=\>))*([A-Z]*|[>])*([tmhfb]{1})*(-(?=[0-9]+))*([0-9]*)(?:n([0-9]*)(?:,)*([0-9]*))*)*$/.exec(cells);if(null===matches)return!1;function _smartRow(index){return parseInt(index)+_rowRefs.dt-1}var tempCol,tempRow,results={smartRow:matches[1],fromColEndSubtractAmount:matches[2],fromCol:matches[3],fromSmartRow:matches[4],fromRowEndSubtract:matches[5],fromRow:matches[6],range:matches[7],toColEndSubtractAmount:matches[8],toCol:matches[9],toSmartRow:matches[10],toRowEndSubtract:matches[11],toRow:matches[12],nthCol:matches[13],nthRow:matches[14],pattern:cells};return!!function(results,smartRowOption){if(!(smartRowOption||results.smartRow&&"s"==results.smartRow))return results.smartRow=!1,1;results.smartRow=!0,results.fromRow&&!results.fromRowEndSubtract&&(results.fromRow=_smartRow(results.fromRow)),results.toRow&&!results.toRowEndSubtract&&(results.toRow=_smartRow(results.toRow));var match,pattern=/['tmhfb']{1}/;if(results.fromSmartRow!==undefined){if(!(match=pattern.exec(results.fromSmartRow))||!1===_rowRefs[match[0]])return;results.fromRow=_rowRefs[match[0]]}if(results.toSmartRow!==undefined){if(!(match=pattern.exec(results.toSmartRow))||!1===_rowRefs[match[0]])return;results.toRow=_rowRefs[match[0]]}return 1}(results,smartRowOption)&&(results.toCol=(results.toCol?results.toColEndSubtractAmount?_getMaxColumnIndex(sheet)-results.toColEndSubtractAmount:results.toCol:null)||(results.range||!results.fromCol?_getMaxColumnIndex(sheet):results.fromColEndSubtractAmount?_getMaxColumnIndex(sheet)-results.fromColEndSubtractAmount:results.fromCol),results.toCol=_parseColumnName(results.toCol,sheet),results.fromCol=results.fromCol?results.fromColEndSubtractAmount?_getMaxColumnIndex(sheet)-results.fromColEndSubtractAmount:results.fromCol:1,results.fromCol=_parseColumnName(results.fromCol,sheet),results.nthCol=results.nthCol?parseInt(results.nthCol):1,results.fromCol>results.toCol&&(tempCol=results.fromCol,results.fromCol=results.toCol,results.toCol=tempCol),results.toRow=(results.toRow?results.toRowEndSubtract?_getMaxRow(sheet,results)-results.toRow:results.toRow:null)||(results.range||!results.fromRow?_getMaxRow(sheet,results):results.fromRowEndSubtract?_getMaxRow(sheet,results)-results.fromRow:results.fromRow),results.toRow=parseInt(results.toRow),results.fromRow=results.fromRow?parseInt(results.fromRowEndSubtract?_getMaxRow(sheet,results)-results.fromRow:results.fromRow):_getMinRow(results),results.nthRow=results.nthRow?parseInt(results.nthRow):1,results.fromRow>results.toRow&&(tempRow=results.fromRow,results.fromRow=results.toRow,results.toRow=tempRow),results)}function _parseCellName(cellName){var matches=/^([A-Z]+)([0-9]+)$/.exec(cellName);return null!==matches&&{col:_parseColumnName(matches[1]),row:matches[2]}}var _getMaxRow=function(sheet,results){return results.smartRow?_rowRefs.db:_getMaxSheetRow(sheet)},_getMinRow=function(results){return results.smartRow?_rowRefs.dt:1},_getMaxSheetRow=function(sheet){return Number($("sheetData row",sheet).last().attr("r"))},_getMaxColumnIndex=function(sheet){var maxColumn=0;return $("cols col",sheet).each(function(){var colMax=Number($(this).attr("max"));maxColumn<colMax&&(maxColumn=colMax)}),maxColumn},_parseColumnName=function(columnName,sheet){if("number"==typeof columnName)return columnName;if(">"==columnName)return _getMaxColumnIndex(sheet);for(var alpha="ABCDEFGHIJKLMNOPQRSTUVWXYZ",result=0,i=0,j=columnName.length-1;i<columnName.length;i+=1,--j)result+=Math.pow(alpha.length,j)*(alpha.indexOf(columnName[i])+1);return Number(result)},_parseColumnIndex=function(index){--index;var letter=String.fromCharCode(65+index%26),nextNumber=parseInt(index/26);return 0<nextNumber?_parseColumnIndex(nextNumber)+letter:letter},_rowRefs={t:!1,m:!1,h:!1,dt:!1,db:!1,f:!1,b:!1};function _loadRowRefs(config,sheet){var currentRow=1;"string"==typeof config.title&&""!==config.title&&(_rowRefs.t=currentRow,currentRow++),null!==config.messageTop&&""!==config.messageTop&&(_rowRefs.m=currentRow,currentRow++),!1!==config.header&&(_rowRefs.h=currentRow,currentRow++),_rowRefs.dt=currentRow;currentRow=_getMaxSheetRow(sheet);null!==config.messageBottom&&""!==config.messageBottom&&(_rowRefs.b=currentRow,currentRow--),!1!==config.footer&&(_rowRefs.f=currentRow,currentRow--),_rowRefs.db=currentRow}function _makeArray(value){return Array.isArray(value)?value:[value]}function _insertCells(insertCells,sheet,config){insertCells=_makeArray(insertCells);var maxCol=0,initialWidth=$("col",sheet).length,maxWidth=0;for(var j in insertCells){var insertObject=insertCells[j],cells=insertObject.cells!==undefined?_makeArray(insertObject.cells):["1:"],smartRowRef=!1;for(var i in insertObject.rowref&&"smart"==style.rowref&&(smartRowRef=!0),cells){var selection=_parseExcellyReference(cells[i],sheet,smartRowRef);if(!1!==selection)for(var contentArrayIndex=0,col=selection.fromCol;col<=selection.toCol;col+=selection.nthCol){maxWidth=0,maxCol<col&&(maxCol=col);for(var colLetter=_parseColumnIndex(col),row=selection.fromRow;row<=selection.toRow;row+=selection.nthRow){var cellId=String(colLetter)+String(row),smartRowID=function(rowIndex){if(rowIndex>=_rowRefs.dt&&rowIndex<=_rowRefs.db)return rowIndex-_rowRefs.dt+1;switch(rowIndex){case _rowRefs.t:return"t";case _rowRefs.m:return"m";case _rowRefs.h:return"h";case _rowRefs.f:return"f";case _rowRefs.b:return"b";default:return undefined}}(row),text=insertObject.content;"function"==typeof insertObject.content&&(text=insertObject.content(cellId,col,row,smartRowID)),Array.isArray(text)&&(contentArrayIndex>=text.length&&(contentArrayIndex=0),text=text[contentArrayIndex],contentArrayIndex++);var width=_calcColWidth(text);maxWidth<width&&(maxWidth=width);var newCol,newRow,cell=_createNode(sheet,"c",{attr:{t:"inlineStr",r:cellId},children:{row:_createNode(sheet,"is",{children:{row:_createNode(sheet,"t",{text:text,attr:{"xml:space":"preserve"}})}})}}),existingCell=_getExistingCell(cellId,sheet);!1!==existingCell?insertObject.pushRow!==undefined&&!0===insertObject.pushRow?(newRow=_createNode(sheet,"row",{attr:{r:row}}),existingCell.parent().before(newRow),_pushRow(existingCell.parent(),1),existingCell.parent().nextAll().each(function(){_pushRow($(this),1)}),newRow.appendChild(cell)):insertObject.pushCol!==undefined&&!0===insertObject.pushCol?(existingCell.before(cell),newCol=_pushCol(existingCell,1),maxCol<newCol&&(maxCol=newCol),existingCell.nextAll().each(function(){newCol=_pushCol($(this),1),maxCol<newCol&&(maxCol=newCol)})):existingCell.replaceWith(cell):$("row",sheet)[row-1].appendChild(cell)}_addColIfRequired(col,maxCol,maxWidth,sheet)}}_loadRowRefs(config,sheet)}_pushMergedColEnd(initialWidth,sheet)}var _calcColWidth=function(str){var lineSplit,len=-1!==str.indexOf("\n")?((lineSplit=str.split("\n")).sort(function(a,b){return b.length-a.length}),lineSplit[0].length):str.length;return len},_addColIfRequired=function(insertedCol,maxCol,maxWidth,sheet){var sheetColCount=sheet.getElementsByTagName("col").length;if(sheetColCount<maxCol){40<maxWidth&&(maxWidth=40),maxWidth<6&&(maxWidth=6),maxWidth*=1.35;for(var insertBefore=sheet.getElementsByTagName("col")[insertedCol-1],i=sheetColCount+1;i<=maxCol;i++){var newCol=_createNode(sheet,"col",{attr:{min:i,max:i,width:maxWidth,customWidth:1}});sheet.getElementsByTagName("cols")[0].insertBefore(newCol,insertBefore)}_updateCellMinMax(sheet)}else{40<maxWidth&&(maxWidth=40),maxWidth<6&&(maxWidth=6),maxWidth*=1.35;var column=sheet.getElementsByTagName("col")[insertedCol-1],currentWidth=$(column).attr("width");currentWidth<6&&(currentWidth=6),currentWidth<maxWidth&&($(column).attr("width",maxWidth),$(column).attr("customWidth",1))}},_updateCellMinMax=function(sheet){for(var cells=sheet.getElementsByTagName("col"),i=0;i<cells.length;i++){var cell=$(cells[i]);cell.attr("min",i+1),cell.attr("max",i+1)}},_getExistingCell=function(cellId,sheet){var cell=$('sheetData row c[r="'+cellId+'"]',sheet);return 0!==cell.length&&cell},_pushMergedColEnd=function(initialWidth,sheet){var newWidth=$("col",sheet).length;if(newWidth!=initialWidth){var mergeCells=sheet.getElementsByTagName("mergeCell");if(0<mergeCells.length)for(var i=0;i<mergeCells.length;i++){var newRef,mc=mergeCells[i],ref=_parseExcellyReference($(mc).attr("ref"),sheet,!1);ref.toCol>=initialWidth&&(newRef=_parseColumnIndex(ref.fromCol)+String(ref.fromRow)+":"+_parseColumnIndex(newWidth)+String(ref.toRow),$(mc).attr("ref",newRef))}}},_pushRow=function(row,rowsToPush){var rowID=row.attr("r"),newRowID=parseInt(rowID)+rowsToPush;row.attr("r",newRowID),row.children().each(function(){var cell=$(this),cellID=cell.attr("r"),cellColRow=_parseCellName(cellID),newCellID=String(_parseColumnIndex(cellColRow.col))+String(newRowID);cell.attr("r",newCellID)})},_pushCol=function(cell,colsToPush){var cellID=cell.attr("r"),cellColRow=_parseCellName(cellID),newCellID=String(_parseColumnIndex(cellColRow.col+colsToPush))+String(cellColRow.row);return cell.attr("r",newCellID),cellColRow.col+1},_createNode=function(doc,nodeName,opts){var tempNode=doc.createElement(nodeName);return opts&&(opts.attr&&$(tempNode).attr(opts.attr),opts.children&&$.each(opts.children,function(key,value){tempNode.appendChild(value)}),null!==opts.text&&opts.text!==undefined&&tempNode.appendChild(doc.createTextNode(opts.text))),tempNode};DataTable.ext.buttons.excelHtml5._applyExcelStyles=function(xlsx){var sheet=xlsx.xl.worksheets["sheet1.xml"];_xmlStyleDoc=xlsx.xl["styles.xml"];var config=DataTable.Api().buttons.exportInfo(this);config.header=this.header,config.footer=this.footer,_loadRowRefs(config,sheet),this.insertCells!==undefined&&_insertCells(this.insertCells,sheet,config),this.pageStyle!==undefined&&_applyPageStyle(this.pageStyle,sheet,xlsx);var excelStyles=this.excelStyles||this.exportOptions.excelStyles;if(excelStyles!==undefined){excelStyles=_makeArray(excelStyles);var tag_cache=[],sheet_data=sheet.querySelectorAll("sheetData row");for(var i in excelStyles){var style=excelStyles[i],styleLookup={},styleId=!1;style.index!==undefined&&"number"==typeof style.index&&(styleId=style.index);var cells=style.cells!==undefined?_makeArray(style.cells):["1:"],smartRowRef=!1;for(var i in style.rowref&&"smart"==style.rowref&&(smartRowRef=!0),cells){var selection=_parseExcellyReference(cells[i],sheet,smartRowRef);if(!1!==selection)if(style.condition==undefined){for(var col=selection.fromCol;col<=selection.toCol;col+=selection.nthCol){for(var colref,colLetter=_parseColumnIndex(col),row=selection.fromRow;row<=selection.toRow;row+=selection.nthRow){var tag=colLetter+row;if(tag_cache[tag]==undefined){if(sheet_data[row-1]==undefined||sheet_data[row-1].childNodes[col-1]==undefined)continue;var cacheCellRef=sheet_data[row-1].childNodes[col-1],cellInitialStyle=cacheCellRef.getAttribute("s")||0;tag_cache[tag]={cellRef:cacheCellRef,initialStyle:cellInitialStyle,style:cellInitialStyle}}var mergeWithCellStyle,newStyleId,currentCellStyle=tag_cache[tag].style;styleLookup[currentCellStyle]==undefined&&(newStyleId=0===currentCellStyle&&styleId?styleId:(mergeWithCellStyle=style.merge===undefined||style.merge?currentCellStyle:0,_addXMLStyle(styleId||style,mergeWithCellStyle)),styleLookup[currentCellStyle]=newStyleId),tag_cache[tag].style=styleLookup[currentCellStyle]}style.width!==undefined&&((colref=sheet.querySelector('col[min="'+col+'"]')).setAttribute("width",style.width),colref.setAttribute("customWidth",!0))}for(var rwref,row=selection.fromRow;row<=selection.toRow;row+=selection.nthRow){style.height!==undefined&&((rwref=sheet.querySelector('row[r="'+row+'"]')).setAttribute("ht",style.height),rwref.setAttribute("customHeight",!0))}}else _addConditionalStyle(sheet,style,selection)}}for(var i in tag_cache)tag_cache[i].style!=tag_cache[i].initialStyle&&tag_cache[i].cellRef.setAttribute("s",tag_cache[i].style)}};function _findNodeValue(keyArray){var val=_translateAttributes;for(var i in keyArray)if(null!==keyArray[i]){if(val[keyArray[i]]===undefined)return undefined;val=val[keyArray[i]]}return val}function _isTextNode(nodeHierarchy,attributeName){var value=_findNodeValue(nodeHierarchy.concat([attributeName]));return value!==undefined&&value.textNode!==undefined&&!0===value.textNode}function _getTranslatedKey(nodeHierarchy,tagName){var newKey=_findNodeValue(nodeHierarchy.concat(["translate",tagName]));return newKey!==undefined?newKey:tagName}function _addXMLAttribute(styleType,attributeName,attributeValues,parentNode,nodeHierarchy){if("object"==typeof attributeValues)for(var attributeKey in attributeValues=_mergeDefault(nodeHierarchy,attributeValues)){var value=attributeValues[attributeKey],key=_getTranslatedKey(nodeHierarchy,attributeKey);!function(nodeHierarchy,attributeName){var value=_findNodeValue(nodeHierarchy.concat([attributeName]));return value!==undefined&&value.child!==undefined&&!0===value.child}(nodeHierarchy,key)?_isTextNode(nodeHierarchy,key)?parentNode.appendChild(_xmlStyleDoc.createTextNode(value)):$(parentNode).attr(key,value):_addXMLNode(styleType,key,value,parentNode,nodeHierarchy)}else if(""!==attributeValues){var txAttr=function(attributeValue,nodeHierarchy){var attributeName="val",tKey=_findNodeValue(nodeHierarchy.concat([attributeName]));tKey!==undefined&&(attributeName=tKey,tKey=_findNodeValue(nodeHierarchy.concat([attributeName]))),tKey!==undefined&&tKey.tidy!==undefined&&(attributeValue=tKey.tidy(attributeValue));var obj={};return obj[attributeName]=attributeValue,obj}(attributeValues,nodeHierarchy);for(var i in txAttr)_isTextNode(nodeHierarchy,i)?parentNode.appendChild(_xmlStyleDoc.createTextNode(txAttr[i])):parentNode.setAttribute(i,txAttr[i])}}var _xmlStyleDoc,_applyPageStyle=function(pageStyle,sheet,xlsx){for(var type in pageStyle=_mergeDefault(["worksheet"],pageStyle)){var attributeValue=pageStyle[type];switch(type){case"repeatHeading":case"repeatRow":_addRepeatHeading(attributeValue,sheet,xlsx);break;case"repeatCol":_addRepeatColumns(attributeValue,sheet,xlsx);break;default:var parentNode=sheet.getElementsByTagName("worksheet")[0];_addXMLNode("pageStyle",type,attributeValue,parentNode,["worksheet"])}}},_addRepeatHeading=function(value,sheet,xlsx){var rows="sh:h";!0!==value&&!1!==value&&(rows=value);var rowSelection=_parseExcellyReference(rows,sheet,!1),selectionString="Sheet1!$"+rowSelection.fromRow+":$"+rowSelection.toRow;_addRepeat(selectionString,xlsx)},_addRepeatColumns=function(value,sheet,xlsx){var cols="A:A";!0!==value&&!1!==value&&(cols=value);var colSelection=_parseExcellyReference(cols,sheet,!1),selectionString="Sheet1!$"+_parseColumnIndex(colSelection.fromCol)+":$"+_parseColumnIndex(colSelection.toCol);_addRepeat(selectionString,xlsx)},_addRepeat=function(selectionString,xlsx){var workbook=xlsx.xl["workbook.xml"],parentNode=workbook.getElementsByTagName("workbook")[0],repeats=[],existing=workbook.getElementsByName("_xlnm.Print_Titles");0<existing.length&&(repeats.push(existing[0].textContent),existing[0].textContent=""),repeats.push(selectionString);var addObject={definedName:{name:"_xlnm.Print_Titles",localSheetId:"0",rows:repeats.join(",")}};_addXMLNode("workbook","definedNames",addObject,parentNode,["workbook"])},_translateAttributes={conditionalFormatting:{cfRule:{default:{priority:"1"},formula:{child:!0,merge:!1,val:"formulaValue",formulaValue:{textNode:!0}},dataBar:{child:!0,default:{cfvo:[{type:"min",val:0},{type:"max",val:0}]},cfvo:{child:!0,merge:!1},color:{child:!0,val:"rgb"}},colorScale:{child:!0,default:{cfvo:[{type:"min",val:0},{type:"max",val:0}]},cfvo:{child:!0,merge:!1},color:{child:!0,merge:!1,val:"rgb"}},iconSet:{child:!0,default:{iconSet:"4Rating",cfvo:[{type:"percentile",val:0},{type:"percentile",val:33},{type:"percentile",val:67},{type:"percentile",val:100}]},cfvo:{child:!0,merge:!1}}}},font:{translate:{size:"sz",strong:"b",bold:"b",italic:"i",underline:"u"},color:{val:"rgb"}},fill:{translate:{pattern:"patternFill",gradient:"gradientFill"},patternFill:{default:{patternType:"solid",fgColor:"",bgColor:""},translate:{type:"patternType",color:"fgColor"},replace:"gradientFill",fgColor:{child:!0,val:"rgb"},bgColor:{child:!0,val:"rgb"}},gradientFill:{replace:"patternFill",merge:!1,stop:{merge:!1,child:!0,color:{child:!0,val:"rgb"}}}},border:{default:{left:"",right:"",top:"",bottom:"",diagonal:"",vertical:"",horizontal:""},top:{val:"style",color:{child:!0,val:"rgb"}},bottom:{val:"style",color:{child:!0,val:"rgb"}},left:{val:"style",color:{child:!0,val:"rgb"}},right:{val:"style",color:{child:!0,val:"rgb"}},diagonal:{val:"style",color:{child:!0,val:"rgb"}},horizontal:{val:"style",color:{child:!0,val:"rgb"}},vertical:{val:"style",color:{child:!0,val:"rgb"}}},worksheet:{default:{printOptions:"",pageMargins:{left:"0.7",right:"0.7",top:"0.75",bottom:"0.75",header:"0.3",footer:"0.3"},pageSetup:""},mergeCells:{updateCount:!0,mergeCell:{child:!0,merge:!1,val:"ref"}},sheetPr:{insertBefore:"cols",pageSetUpPr:{child:!0}}},workbook:{definedNames:{insertBefore:"calcPr",definedName:{child:!0,rows:{textNode:!0,merge:!1}}}}},_mergeDefault=function(nodeHierarchy,obj){var mergeObj=_findNodeValue(nodeHierarchy.concat(["default"]));return mergeObj!==undefined?$.extend({},mergeObj,obj):obj},_addXMLNode=function(styleType,attributeName,attributeValue,parentNode,nodeHierarchy){attributeName=_getTranslatedKey(nodeHierarchy,attributeName);_purgeUnwantedSiblings(attributeName,parentNode,nodeHierarchy),attributeValue=_makeArray(attributeValue);var position,beforeNode,childNode,mergeWith=_doWeMerge(attributeName,nodeHierarchy);for(var i in attributeValue){childNode=mergeWith&&0!==parentNode.getElementsByTagName(attributeName).length?parentNode.getElementsByTagName(attributeName)[0]:"end"===(position=function(nodeHierarchy,tagName){var value=_findNodeValue(nodeHierarchy.concat([tagName,"insertBefore"]));return value===undefined?"end":value}(nodeHierarchy,attributeName))?parentNode.appendChild(_xmlStyleDoc.createElement(attributeName)):(beforeNode=parentNode.getElementsByTagName(position)[0],parentNode.insertBefore(_xmlStyleDoc.createElement(attributeName),beforeNode)),_addXMLAttribute(styleType,0,attributeValue[i],childNode,nodeHierarchy.concat(attributeName))}!function(nodeHierarchy,attributeName){var value=_findNodeValue(nodeHierarchy.concat([attributeName]));return value!==undefined&&value.updateCount!==undefined&&!0===value.updateCount}(nodeHierarchy,attributeName)||_updateContainerCount(childNode)},_doWeMerge=function(attributeName,nodeHierarchy){var merge=_findNodeValue(nodeHierarchy.concat([attributeName,"merge"]));return merge===undefined||!1!==merge},_purgeUnwantedSiblings=function(attributeName,parentNode,nodeHierarchy){var match,replace=_findNodeValue(nodeHierarchy.concat([attributeName,"replace"]));replace===undefined||0<(match=parentNode.getElementsByTagName(replace)).length&&parentNode.removeChild(match[0])},_addXMLStyle=function(addStyle,currentCellStyle){return"object"==typeof addStyle&&addStyle.style===undefined?currentCellStyle:("object"==typeof addStyle?_mergeWithStyle:_mergeWithBuiltin)(addStyle,currentCellStyle)},_mergeWithBuiltin=function(builtInIndex,currentCellStyle){for(var cellXfs=_xmlStyleDoc.getElementsByTagName("cellXfs")[0],currentStyleXf=cellXfs.getElementsByTagName("xf")[currentCellStyle],mergeStyleXf=cellXfs.getElementsByTagName("xf")[builtInIndex],xf=cellXfs.appendChild(currentStyleXf.cloneNode(!0)),types=["font","fill","border","numFmt"],i=0;i<types.length;i++){var id=types[i]+"Id";if(mergeStyleXf.hasAttribute(id)&&xf.hasAttribute(id)){var mergeId=mergeStyleXf.getAttribute(id),typeId=xf.getAttribute(id),parentNode=_xmlStyleDoc.getElementsByTagName(types[i]+"s")[0],mergeNode=parentNode.childNodes[mergeId];if(mergeId!=typeId)if("numFmtId"==id)0<mergeId&&xf.setAttribute(id,mergeId);else{var childNode=parentNode.childNodes[typeId].cloneNode(!0);parentNode.appendChild(childNode),_updateContainerCount(parentNode),xf.setAttribute(id,parentNode.childNodes.length-1);for(var mergeNodeChildren=mergeNode.childNodes,key=0;key<mergeNodeChildren.length;key++){var newAttr=mergeNodeChildren[key].cloneNode(!0),attr=childNode.getElementsByTagName(mergeNodeChildren[key].nodeName);attr[0]?childNode.replaceChild(newAttr,attr[0]):childNode.appendChild(newAttr)}}}}return cellXfs.childNodes.length-1},_mergeWithStyle=function(addStyle,currentCellStyle){var cellXfs=_xmlStyleDoc.getElementsByTagName("cellXfs")[0],style=addStyle.style,existingStyleXf=cellXfs.getElementsByTagName("xf")[currentCellStyle],xf=cellXfs.appendChild(existingStyleXf.cloneNode(!0));for(var type in style){var lastId,numFmtId,existingTypeId,parentNode,typeNode=_xmlStyleDoc.getElementsByTagName(type+"s")[0],styleId=type+"Id";if("alignment"!=type)if("numFmt"==type){"number"==typeof style[type]?xf.setAttribute(styleId,style[type]):((parentNode=_xmlStyleDoc.createElement(type)).setAttribute("formatCode",style[type]),lastId=typeNode.lastChild.getAttribute("numFmtId"),numFmtId=Number(lastId)+1,parentNode.setAttribute("numFmtId",numFmtId),typeNode.appendChild(parentNode),_updateContainerCount(typeNode),xf.setAttribute(styleId,numFmtId))}else{for(var attributeName in parentNode=xf.hasAttribute(styleId)?(existingTypeId=xf.getAttribute(styleId),typeNode.childNodes[existingTypeId].cloneNode(!0)):_xmlStyleDoc.createElement(type),typeNode.appendChild(parentNode),style[type]=_mergeDefault([type],style[type]),style[type]){var attributeValue=style[type][attributeName];_addXMLNode(type,attributeName,attributeValue,parentNode,[type])}xf.setAttribute(styleId,typeNode.childNodes.length-1),_updateContainerCount(typeNode)}}return style.alignment!==undefined&&(_addXMLNode("xf","alignment",style.alignment,xf,"xf"),xf.setAttribute("applyAlignment","1")),_updateContainerCount(cellXfs),cellXfs.childNodes.length-1},_addConditionalStyle=function(sheet,excelStyle,selection){var dxfs=_xmlStyleDoc.getElementsByTagName("dxfs")[0],dxfNode=_xmlStyleDoc.createElement("dxf");dxfs.appendChild(dxfNode),_updateContainerCount(dxfs);var parentNode,style=excelStyle.style?excelStyle.style:{};for(var type in style)for(var attributeName in parentNode=_xmlStyleDoc.createElement(type),dxfNode.appendChild(parentNode),style[type]=_mergeDefault([type],style[type]),style[type]){var attributeValue=style[type][attributeName];_addXMLNode(type,attributeName,attributeValue,parentNode,[type])}var dxfId=dxfs.childNodes.length-1,worksheet=sheet.getElementsByTagName("worksheet")[0],conditionalFormatting=sheet.createElement("conditionalFormatting"),cellRef=_getRangeFromSelection(selection);conditionalFormatting.setAttribute("sqref",cellRef),worksheet.appendChild(conditionalFormatting);var condition=excelStyle.condition;condition.dxfId=dxfId,_addXMLNode("conditionalFormatting","cfRule",condition,conditionalFormatting,["conditionalFormatting"])},_getRangeFromSelection=function(selection){return _parseColumnIndex(selection.fromCol)+String(selection.fromRow)+":"+_parseColumnIndex(selection.toCol)+String(selection.toRow)},_updateContainerCount=function(container){container.setAttribute("count",container.childNodes.length)};return DataTable.Buttons});